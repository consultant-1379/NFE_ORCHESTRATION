
define('text!widgets/Button/_button.html',[],function () { return '<button class="ebBtn">\n    <span class="ebBtn-caption"></span>\n</button>';});

/*global define*/
define('widgets/Button/ButtonView',[
    "jscore/core",
    "text!./_button.html"
], function (core, template) {
    

    var ButtonView = core.View.extend({
        init: function () {
            // used for the icon, icon depends on button size
            this.size = 'medium';
        },
        setSize: function (size) {
            if (size) {
                this.size = size;
                var icnElt = this.getIcon();
                if (icnElt && this.size !== 'medium') {
                    icnElt.setModifier(this.size);
                }
            }
        },
        getTemplate: function () {
            return template;
        },
        getCaption: function () {
            return this.getElement().find('.' + ButtonView.BTN_CAPTION);
        },
        getIcon: function () {
            return this.getElement().find('.' + ButtonView.EB_ICON);
        },
        setIcon: function (options) {
            var iconElt = this.getIcon();
            var caption = this.getCaption();

            if (options) {
                if (!iconElt) {
                    iconElt = core.Element.parse('<i></i>');
                    iconElt.setAttribute('class', ButtonView.EB_ICON);

                    var position = options.position;
                    var captionText = caption.getText().trim();

                    if (position && position === 'left') {
                        caption.detach(); // no prepend in JSCore
                        caption.setText(' ' + captionText);
                        this.getElement().append(iconElt);
                        this.getElement().append(caption);

                    } else {
                        this.getElement().append(iconElt);
                        caption.setText(captionText + ' ');
                    }
                }

                iconElt.setModifier(options.name);
                this.setSize(this.size);

            } else {
                // remove the icon elt if options is null
                if (iconElt) {
                    iconElt.remove();
                }
                return;
            }
        }

    }, {
        BTN_CAPTION: 'ebBtn-caption',
        EB_ICON: 'ebIcon'
    });
    return ButtonView;
});

/*global define*/
define('widgets/Button/Button',[
    'widgets/main',
    './ButtonView'
], function (core, View) {
    

    /**
     * The Button class wraps the Ericsson brand assets button in a Widget.<br>
     * The Button can be instantiated using the constructor Button.
     *
     * <strong>Events:</strong>
     * <ul>
     *     <li>click - Triggers when the button has been clicked.</li>
     * </ul>
     *
     * The following options are accepted:
     *   <ul>
     *       <li>caption: a string used as a button caption.</li>
     *       <li>enabled: boolean indicating whether button should be enabled. Default is true.</li>
     *       <li>modifiers: an array used to define modifiers for the Button. (Asset Library)
     *          <a name="modifierAvailableList"></a>
     *          <br>E.g: modifiers:[{name: 'foo'}, {name: 'bar', value:'barVal'}]
     *          <ul style="padding-left: 15px;">
     *              <li>noMargin: set the margin to 0 around the widget (Asset Library)</li>
     *              <li>disabled: disabled (equiv DOM attribute disabled) (Asset Library)</li>
     *              <li>small: size variation small</li>
     *              <li>large: size variation large</li>
     *              <li>Color modifiers:
     *              <br>color_darkGreen, color_green, color_orange, color_red, color_purple, color_paleBlue
     *              <br>E.g: modifiers:[{name: 'color', value:'green'}]
     *              <br>(List of colors defined in the Asset Library)
     *              </li>
     *          </ul>
     *       </li>
     *       <li>type: a string used as a button type attribute. Default is 'button'.</li>
     *   </ul>
     *
     * @class Button
     */
    //noinspection JSHint
    return core.Widget.extend({

        View: View,

        /**
         * Adds the Widget's element to the new parent element.
         *
         * @method attachTo
         * @param {Element} parent
         * @example
         *    widget.attachTo(this.getElement());
         */

        /**
         * Places the detached Widget back into the defined parent element.
         *
         * @method attach
         * @example
         *  widget.attach();
         */

        /**
         * Removes the Widget from the parent element, but does not destroy the Widget. DOM events will still work when Widget is attached back.
         *
         * @method detach
         * @example
         *  widget.detach();
         */

        /**
         * Overrides method from widget.
         * Executes every time, when added back to the screen.
         *
         * @method onViewReady
         * @private
         */
        onViewReady: function () {
            this.setCaption(this.options.caption || 'Button');
            this.setModifiers(this.options.modifiers || []);
            this.setType(this.options.type || 'button');
            if (this.options.enabled === false) {
                this.disable();
            }

            if (this.options.icon){
                this.setIcon(this.options.icon);
            }

            this.getElement().addEventHandler('click', function () {
                this.trigger('click');
            }, this);
        },

        /**
         * Sets caption for the button.
         *
         * @method setCaption
         * @param {String} caption
         */
        setCaption: function (caption) {
            this.view.getCaption().setText(caption);
        },

        /**
         * Sets icon for the button.<br>
         * position: left, right (default)<br>
         * name: icon name<br>
         *
         * @method setIcon
         * @param {object} icon null to remove
         * @example
         *   button.setIcon({
         *       position: 'left',
         *       name: 'refresh'
         *   })
         *
         */
        setIcon: function (icon) {
            this.view.setIcon(icon);
        },

        /**
         * Sets 'type' attribute for the button.<br>
         * types: submit, button (default), reset
         *
         * @method setType
         * @param type
         * @example
         *   button.setType('submit');
         */
        setType: function (type) {
            this.getElement().setAttribute('type', type);
        },

        /**
         * Enables the button.
         *
         * @method enable
         */
        enable: function () {
            this.getElement().setAttribute('disabled', null);
            this.getElement().removeModifier('disabled');
        },

        /**
         * Disables the button.
         *
         * @method disable
         */
        disable: function () {
            this.getElement().setAttribute('disabled', 'disabled');
            this.getElement().setModifier('disabled');
        },

        /**
         * Add a single modifier to the widget.<br>
         * <a href="#modifierAvailableList">see available modifiers</a>
         *
         * @method setModifier
         * @param {String} key
         * @param {String|int|boolean} value
         */
        setModifier: function (key, value) {
            this.getElement().setModifier(key, value);
            if(key === 'small' || key === 'large'){
                this.view.setSize(key);
            }
        },

        /**
         * A methods, which allows to define a list of modifiers to the widget.<br>
         * <a href="#modifierAvailableList">see available modifiers</a>
         *
         * @method setModifiers
         * @param {Array} modifiers Contains objects {name: {String}[, value: {String}]}
         */
        setModifiers: function (modifiers) {
            modifiers.forEach(function (modifier) {
                this.setModifier(modifier.name, modifier.value);
            }, this);
        },

        /**
         * Remove the modifier 'key' from the widget modifiers.
         *
         * @method removeModifier
         * @param {String} key
         */
        removeModifier: function (key) {
            this.getElement().removeModifier(key);
        }

    });

});

define('widgets/Button', ['widgets/Button/Button'], function (main) { return main; });
